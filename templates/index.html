<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MIB Browser</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>

<div class="top-bar">
    <div class="search-box">
        <input type="search" id="search" placeholder="Search MIBs..." autocomplete="off">
        <div id="search-results" class="search-results-box" style="display: none;"></div>
    </div>
</div>

<div class="container">
    <div id="sidebar" class="sidebar">
        <button id="sidebar-toggle" class="sidebar-toggle-btn">&laquo;</button>
        <div class="sidebar-content">
            <form action="{{ url_for('upload') }}" method="post" enctype="multipart/form-data" class="upload-form">
                <label for="file-upload" class="upload-button">Upload .mib/.txt</label>
                <input id="file-upload" type="file" name="file[]" multiple onchange="this.form.submit()">
            </form>
            <form action="{{ url_for('clear_all') }}" method="post" onsubmit="return confirm('Delete all uploaded MIBs and clear data?');" class="clear-form">
                <input type="submit" value="Clear Uploads" class="clear-button">
            </form>
            <div class="module-list">
                {{ modlist_html|safe }}
            </div>
        </div>
    </div>

    <div id="main-content" class="main-content">
        <div id="module-view" class="module-view-panel">
            <div id="tree-controls" class="tree-controls" style="display: none;">
                <button id="expand-all-btn">Expand All</button>
                <button id="collapse-all-btn">Collapse All</button>
            </div>
            
            <!-- THIS IS THE FIX: ADD THE MISSING #module-header ELEMENT -->
            <div id="module-header"></div>
            
            <div id="tree-container">
                {% if not modules %}
                    <div class="welcome-message">
                        <h2>Welcome</h2>
                        <p>Upload one or more MIB source files (.mib, .txt). We parse them directly and render a browsable tree.</p>
                    </div>
                {% else %}
                     <div class="welcome-message">
                        <h2>Welcome</h2>
                        <p>Pick a module on the left to view its tree.</p>
                    </div>
                {% endif %}
            </div>
        </div>

        <div id="resizer" class="resizer"></div>

        <div id="inspector" class="inspector-panel" style="display: none;">
            <!-- Inspector content will be injected here -->
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
